<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <title> Tips & Tricks Learned Releasing an Hybrid App Using&nbsp;Steroids.js </title> <meta name="description" content="300ms delay, overscroll, text rendering, 1px borders, local storage, performances, i18n ... After lot of work and an app released, I'm sharing a long list of solutions to problems I ran into while developing an hybrid app."> <meta name="author" content="Marc G Gauthier"> <meta content='user-scalable=no, width=device-width, initial-scale=1.0' name='viewport'> <meta name="google-site-verification" content="x2EpQdOMz-k9fP8hak9I3COaXhnQ4jNLp2GU4GYQ8jM" /> <link href='//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic|Open+Sans:300italic,700italic,400,700,300' rel='stylesheet' type='text/css'> <link href="/atom.xml" rel="alternate" type="application/atom+xml" title="Marcgg#Blog"> <link rel="shortcut icon" href="/assets/favicon.png"> <style type="text/css"> /* http://meyerweb.com/eric/tools/css/reset/ v2.0 | 20110126 License: none (public domain) */ html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video { margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline; } /* HTML5 display-role reset for older browsers */ article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section { display: block; } body { line-height: 1; } ol, ul { list-style: none; } blockquote, q { quotes: none; } blockquote:before, blockquote:after, q:before, q:after { content: ''; content: none; } table { border-collapse: collapse; border-spacing: 0; } .clearfix:after { content: "."; display: block; clear: both; visibility: hidden; line-height: 0; height: 0; } .clearfix { display: inline-block; } html[xmlns] .clearfix { display: block; } * html .clearfix { height: 1%; } @font-face { font-family: 'anonymousregular'; src: url('/assets/fonts/Anonymous-webfont.eot'); src: url('/assets/fonts/Anonymous-webfont.eot?#iefix') format('embedded-opentype'), url('/assets/fonts/Anonymous-webfont.woff') format('woff'), url('/assets/fonts/Anonymous-webfont.ttf') format('truetype'), url('/assets/fonts/Anonymous-webfont.svg#anonymousregular') format('svg'); font-weight: normal; font-style: normal; } body{ font-size: 15px; font-family: 'Droid Serif', serif; color: #545454; line-height: 25px; } #gradient{ height: 5px; background: rgba(237,82,82,0.64); background: -moz-linear-gradient(left, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); background: -webkit-gradient(left top, right top, color-stop(0%, rgba(237,82,82,0.64)), color-stop(20%, rgba(250,21,0,0.65)), color-stop(52%, rgba(237,82,82,0.66)), color-stop(80%, rgba(255,21,0,0.66)), color-stop(100%, rgba(237,82,82,0.67))); background: -webkit-linear-gradient(left, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); background: -o-linear-gradient(left, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); background: -ms-linear-gradient(left, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); background: linear-gradient(to right, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ed5252', endColorstr='#ed5252', GradientType=1 ); } /* STRUCTURE */ #container{ background-color: #fafafa; } #content{ width: 760px; margin: auto; margin-top: 20px; padding-bottom: 60px; padding-top: 40px; } /* FOOTER */ footer{ padding: 40px 0px; text-align: center; border-top: 1px solid #e6e6e6; font-size: 0.8em; color: #9a9a9a; background-color: #fafafa; } footer a{ color: #9a9a9a; } /* HEADER */ header{ width: 760px; margin: auto; height: 50px; border-bottom: 1px solid #f1f1f1; position: relative; } #more-nav{ font-size: 0.75em; display: inline-block;; position: absolute; top: 0px; font-family: "anonymousregular"; padding-top: 5px; right: 0px; } #more-nav a{ padding: 0px 2px; text-decoration: none; color: #545454; } #more-nav a:hover{ transition: 0s; background-image: linear-gradient(to bottom, #fff 30%, rgba(200, 200, 200, 0.4) 50%); background-repeat: repeat-x; background-size: 2px 2px; background-position: 0px 100%; } #more-nav .selected{ color: #ed5252; font-weight: bold; } #logo{ font-size: 1.2em; font-family: "anonymousregular"; margin-top: 20px; } #logo *{ text-decoration: none; } #logo1{ color: #999; } #logo2{ font-size: 0.8em; color: #ed5252; } #logo3{ color: #545454; } #logo a:hover{ color: #ed5252; transition-duration: 1s; } /* TEXT STRUCTURE */ h1, h2, h3, h4, h5{ font-family: 'Open Sans', sans-serif; color: #1c1c1c; } h2, h3, h4, h5{ text-transform: capitalize; } a:hover{ color: #ed5252; transition-duration:0.2s; } p a, ul a, .review a{ color: #763232; text-decoration: none; background-image: linear-gradient(to bottom, #fff 30%, rgba(200, 200, 200, 0.4) 50%); background-repeat: repeat-x; background-size: 2px 2px; background-position: 0px 100%; } p{ text-align: justify; margin-bottom: 20px; } .excerpt p{ margin-bottom: 0px; } .footnote, .sidenote{ margin: 40px 0px; color: #858585; text-align: right; font-size: 0.9em; font-style: italic; } .image_notes{ text-align: center; color: #858585; font-size: 0.9em; margin: -5px 0px 15px 0px; } h1{ font-size: 2.45em; text-align: center; margin: 70px 0px 20px 0px; line-height : 1.5em; } h1 em{ color: #888; font-weight: normal; font-size: 0.8em; } h2{ font-size: 1.75em; margin: 50px 0px 50px 0px; line-height: 1.75em; } h2::before{ content: "#"; color: #ed5252; font-family: "anonymousregular"; display: inline-block; float: left; padding: 3px 10px 0px 0px; font-size: 0.7em; } h3{ font-size: 1.35em; margin-bottom: 20px; } h4{ font-size: 1.2em; margin-bottom: 20px; font-style: italic; } h5{ font-size: 1.3em; margin-bottom: 20px; } h5 *{ color: #545454; } em{ font-style: italic; } strong{ font-weight: bold; } blockquote{ border-left: 3px solid #ddd; color: #888; margin: 0px 0px 20px 40px; font-style: italic; } blockquote p{ margin: 5px 20px !important; } ul{ padding-left: 40px; line-height: 25px; list-style: square; margin-bottom: 20px; } li{ display: list-item; } ol{ padding-left: 40px; line-height: 25px; margin-bottom: 20px; list-style-type: decimal; } /* TAGS */ .home-tag { font-size: 10px; display: inline-block; border: 1px solid #dedede; padding: 2px 2px 1px 2px; border-radius: 2px; line-height: 10px; margin-left: 1px; } .tag-date{ color: #dedede; } .tag-management { border-color: #929aff; color: #929aff; } .tag-programming { border-color: #ff9292; color: #ff9292; } .tag-coaching { border-color: #4ec698; color: #4ec698; } .tag-projectmanagement { border-color: #929aff; color: #929aff; } /* BLOG INDEX */ #all-posts{ margin: 0px auto 10px auto; width: 760px; } .single-post{ border-top: 1px solid #f1f1f1; padding: 40px 0px; float: clear; } .single-post:first-child{ border-top: none !important; } .single-post .date{ color: #cdcdcd; margin-top: 10px; float: right; } .single-post .author{ color: #cdcdcd; float: right; font-size: 0.7em; } .single-post .title{ font-family: 'Open Sans', sans-serif; font-size: 1.6em; margin-bottom: 20px; line-height: 1.6em; position: relative; } .single-post .title a{ color: #545454; text-decoration: none; } .single-post .title a::before{ content: "→"; opacity: 0; font-family: "anonymousregular"; font-size: 0.7em; position: absolute; left: -30px; transition: all .4s ease-in-out; } .single-post .title a:hover::before{ opacity: 1; transition: all .4s ease-in-out; color: #ed5252; } .single-post .title em{ display: none; } .data_table{ border: 1px solid #efefef; font-family: "anonymousregular"; font-size: 12px; margin: auto auto 20px auto; } .data_table tr{ border: 1px solid #efefef; } .data_table th{ background-color: #efefef; } .data_table th, .data_table td{ padding: 2px 5px; } /* BOOKS */ .book-cover-entry{ width: 120px; margin-right: 20px; float: left; font-size: 12px; text-decoration: none !important; } .buy-book{ text-decoration: underline; } .book-cover-entry img{ width: 120px; } .book-cover-entry { background-image: none; } .book-rating .icon { display: inline-block; padding-right: 5px; } .book-rating .top .icon{ color: #1CED00; } .book-rating .good .icon{ color: #82ED00; } .book-rating .medium .icon{ color: #EDD100; } .book-rating .low .icon{ color: #EDAE00; } .book-rating .poor .icon{ color: #ED3B00; } #buy-title{ padding: 0px 0px 25px 0px; } #buy-title span{ font-size: 0.8em !important; color: #cdcdcd; } #buy-popin{ padding: 30px 15px; } .store{ display: block; padding: 15px 5px; text-decoration: none; } .store:hover{ color: #ed5252; } #upcoming-books{ padding-top: 20px; } #upcoming-books img{ height: 90px; margin-right: 10px; border: 1px solid #fff; } #upcoming-books a{ text-decoration: none; } #upcoming-books img:hover{ border: 1px solid #ed5252; } /* BLOG SHOW */ .post{ padding-top: 20px; } p code, li code{ background-color: #efefef; font-family: "Lucida Console", "Courier New", Courier, monospace; padding: 1px 2px; font-size: 13px; } .post img{ border: 1px solid #e6e6e6; padding: 5px; margin: 0px 0px 20px 20px; } .published span{ border-top: 1px solid #e6e6e6; display: inline-block; color: #858585; padding-top: 5px; font-family: 'Open Sans', sans-serif; font-size: 0.9em; padding: 5px 20px 0px 20px; } .published{ text-align: center; margin-bottom: 25px; } #more{ border-top: 1px solid #e6e6e6; margin-top: 40px; padding: 40px 0px; } #more-articles{ margin-bottom: 40px; } .image-wrapper em{ display: block; font-size: 0.8em; margin: -20px 0px 20px 0px; color: #aaa; } .twitter-tweet{ margin: auto; max-width: 420px !important; } #book-review{ border: 1px dashed #dedede; padding: 20px; margin-bottom: 20px; opacity: 0.7; font-style: italic; } /* Music */ .js_play_sound, .js_stop_sound{ display: inline-block; padding: 4px 10px 2px 10px; border: 1px solid #efefef; background-color: #efefef; margin-right: 10px; text-decoration: none; border-radius: 3px; font-family: 'anonymousregular'; font-size: 12px; } .js_play_sound:hover, .js_stop_sound:hover{ background-color: #dedede; } /* Comments */ #comments{ padding-top: 20px; } #show-disqus-arrow{ color: #ed5252; } /* CLEARFIX */ .cf:before, .cf:after { content: " "; /* 1 */ display: table; /* 2 */ } .cf:after { clear: both; } /************************ MOBILE LAYOUT *********************/ @media all and (max-width: 800px) { .home-tag { display: none; } .author{ float: none !important; display: inline; } header{ width: 92%; padding: 4%; height: 75px; position: relative; text-align: center; background-color: #fafafa; } #more-nav{ left: 0px; top: 50px; } #logo{ margin-top: 10px; } #content, #all-posts{ width: 92%; padding: 4%; } .image-wrapper{ width: 100%; } .image-wrapper img, .post div img, .post p img{ max-width: 100% !important; padding: 15px 0px !important; margin: 20px 0px 20px 0px !important; border-right: 0px; border-left: 0px; } .single-post .title{ font-size: 1.4em; } .date{ display: none; } h1{ font-size: 1.7em; width: 94%; padding: 3%; } h2{ font-size: 1.50em; margin: 30px 0px 30px 0px; line-height: 1.75em; } h3{ font-size: 1.30em; } blockquote{ margin: 0px 0px 20px 0px !important; } pre{ margin-left: 0px !important; margin-right: 0px !important; width: 90%; overflow-x: scroll; } code{ width: 100%; font-size: 13px !important; } footer div{ display: inline; } /* Hire me responsive */ #hire ul{ padding-left: 15px; } #talking-img{ width: 100%; } #talking-img img{ width: 100% !important; } #reviews{ border-top: 1px dashed #e6e6e6; padding: 15px 0px 15px 0px; } #references_logo{ padding: 0px 0px 15px 0px; } .review{ width: 100%; margin: 0px 0px 15px 0px; padding: 0px; border-bottom: 1px dashed #e6e6e6; } #references_logo img, #references_logo .minor{ width: 22%; float: left; margin: 15px 2% 15px 0px; } .data_table th, .data_table td{ font-size: 8px; padding: 0px; border: 1px solid #efefef; } } </style> </head> <body> <div id="gradient"></div> <header> <div id="logo"> <a id='logo1' href="/">marcgg</a> <span id='logo2'>#</span> <a id='logo3' href="/blog/"> blog </a> </div> <div id="more-nav"> &rarr; <a href="/blog/" class="selected">blog</a> &rarr; <a href="/books/" class="">books</a> &rarr; <a href="/hire/" class="">hire me</a> </div> </header> <h1> <span> Tips & Tricks Learned Releasing an Hybrid App Using&nbsp;Steroids.js </span> </h1> <div class="published"> <span>09 April 2014</span> </div> <div id="container"> <div id="content"> <div class="post" id="post-"> <p>A while ago I <a href="/blog/2013/08/29/appgyver-steroids-iphone-hybrid-javascript/">wrote about AppGyver’s SteroidsJS</a> and its interesting take on hybrid app development. If you haven’t read it, basically they add the ability to use native UI elements in PhoneGap applications.</p> <p>Since then I’ve teamed up with <a href="http://dribbble.com/kevintunc">Kevin Tunc</a>, worked a lot, managed to actually release something <a href="https://itunes.apple.com/app/liff-understand-your-life/id834944345">on the appstore</a> and won AppGyver’s app of the month!</p> <div style="text-align: center"><img src="/assets/misc/win_app_month.jpg" /></div> <p>It wasn’t all that easy to create an hybrid app with a quality UI, so I figured I’d share some of the gotchas I ran into. I know it’s a longer article than what I use to post, but really this is what I wish was written when I started working on my app.</p> <p>Of course, like any other things I write here, <a href="/blog/2013/11/05/enough-with-the-language-trolls/">I don’t claim to know everything</a>. Please take this as it is: some tips I learned making mistakes and wasting time. I’m no JavaScript guru master ninja 2.0 rock star, <a href="https://www.youtube.com/watch?v=Nh7UgAprdpM">ain’t nobody got time for that</a>! I’ll also focus on iOS because I built an iOS app, but a lot of this applies to Android phones as well. Also note that some parts of the article are just as true for any kind of hybrid app development, be it with PhoneGap or something else.</p> <h2 id="getting-the-device-to-leave-you-alone">Getting The Device To Leave You Alone</h2> <p>You probably know all about using a <a href="http://meyerweb.com/eric/tools/css/reset/">reset.css file</a>, but for a webview trying to pass for a native view, it’s not enough.</p> <h3 id="ms-tap-delay">300ms Tap Delay</h3> <p>Mobile browsers implement a delay on tap to check if you tried to double tap or not. Overall it goes: touchstart -&gt; touchend -&gt; wait 300ms -&gt; send click. This results in a terrible experience when navigating your app as it feels slow and/or broken.</p> <p>For some browsers you can just <a href="http://updates.html5rocks.com/2013/12/300ms-tap-delay-gone-away">specify a viewport and it’ll go away</a>:</p> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, user-scalable=no"</span><span class="nt">&gt;</span></code></pre></figure> <p>If this solution doesn’t work, for instance if your code runs on Safari, use <a href="https://github.com/ftlabs/fastclick">FastClick</a>:</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'load'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">FastClick</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span></code></pre></figure> <h3 id="disable-selectioncopy-when-long-tapping">Disable Selection/Copy When Long Tapping</h3> <p>You know… this thing:</p> <div style="text-align: center"><img src="/assets/misc/copy.jpg" /></div> <p>Fixing this one is pretty easy. For webkit you add this in your CSS:</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nt">-webkit-user-select</span><span class="o">:</span> <span class="nt">none</span><span class="o">;</span>
<span class="nt">-webkit-touch-callout</span><span class="o">:</span> <span class="nt">none</span><span class="o">;</span></code></pre></figure> <h3 id="disable-double-tap">Disable Double Tap</h3> <p>If you don’t like double tapping and use jQuery, try <a href="http://stackoverflow.com/a/9728511">this stackoverflow answer</a>. Just in case this answer disapears, here’s what it looks like:</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// jQuery no-double-tap-zoom plugin</span>
<span class="c1">// Triple-licensed: Public Domain, MIT and WTFPL license - share and enjoy!</span>

<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">IS</span><span class="err">\</span><span class="nx">_IOS</span> <span class="o">=</span> <span class="sr">/iphone|ipad/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">);</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">nodoubletapzoom</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">IS_IOS</span><span class="p">)</span>
	  <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">'touchstart'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">preventZoom</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
	    <span class="kd">var</span> <span class="nx">t2</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">timeStamp</span>
	      <span class="p">,</span> <span class="nx">t1</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">'lastTouch'</span><span class="p">)</span> <span class="o">||</span> <span class="nx">t2</span>
	      <span class="p">,</span> <span class="nx">dt</span> <span class="o">=</span> <span class="nx">t2</span> <span class="o">-</span> <span class="nx">t1</span>
	      <span class="p">,</span> <span class="nx">fingers</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">touches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
	    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">'lastTouch'</span><span class="p">,</span> <span class="nx">t2</span><span class="p">);</span>
	    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dt</span> <span class="o">||</span> <span class="nx">dt</span> <span class="o">&gt;</span> <span class="mi">500</span> <span class="o">||</span> <span class="nx">fingers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span> <span class="c1">// not double-tap</span>
	
	    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span> <span class="c1">// double tap - prevent the zoom</span>
	    <span class="c1">// also synthesize click events we just swallowed up</span>
	    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">'click'</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">'click'</span><span class="p">);</span>
	  <span class="p">});</span>
  <span class="p">};</span>
<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span></code></pre></figure> <h3 id="disable-overscroll">Disable Overscroll</h3> <p>I think that you want the “bounce” effect when you scroll out of a webview. It actually feels better for the end user. However in some specific cases you might need to disable this behavior. There are many ways of doing this and I personnaly used this one from <a href="http://stackoverflow.com/questions/10238084/ios-safari-how-to-disable-overscroll-but-allow-scrollable-divs-to-scroll-norma">stackoverflow</a>:</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">disallowOverscroll</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'touchmove'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
	<span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="p">});</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">'body'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'touchstart'</span><span class="p">,</span><span class="s1">'.scrollable'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	  <span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">scrollHeight</span>
	          <span class="o">===</span> <span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">scrollTop</span>
	              <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">)</span> <span class="p">{</span>
	  <span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
  <span class="p">});</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">'body'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'touchmove'</span><span class="p">,</span><span class="s1">'.scrollable'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">}</span></code></pre></figure> <h3 id="higcharts">Higcharts</h3> <p>If you use <a href="http://www.highcharts.com/">highcharts</a>, you could run into some scrolling trouble when the user touches the graphs. This gist might help: <a href="https://gist.github.com/skarface/2994906">https://gist.github.com/skarface/2994906</a></p> <h3 id="allow-text-selection-for-input">Allow Text Selection For Input</h3> <p>This is an iOS issue. In some cases you won’t be able to select and edit the text in your inputs as you’d like. You can fix this using <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/user-select">user-select</a></p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nt">-webkit-user-select</span><span class="o">:</span> <span class="nt">text</span><span class="o">;</span></code></pre></figure> <h3 id="better-looking-text">Better Looking Text</h3> <p>I noticed that changing the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/text-rendering">text-rendering</a> option gets things to look better. The trade-off is performance, but if you don’t have huge chunks of text you’ll be fine.</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nt">text-rendering</span><span class="o">:</span> <span class="nt">optimizeLegibility</span><span class="o">;</span></code></pre></figure> <h3 id="remove-glossy-looking-buttons-in-safari">Remove Glossy Looking Buttons in Safari</h3> <p>How to go from a glossy stylized button (left) to a cleaner, flatter, easier to update button (right)?</p> <div style="text-align: center"><img src="/assets/misc/glossysafari.jpg" /></div> <p>Easy!</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nt">-webkit-appearance</span><span class="o">:</span> <span class="nt">carret</span><span class="o">;</span>
<span class="nt">-webkit-appearance</span><span class="o">:</span> <span class="nt">none</span><span class="o">;</span> <span class="o">/</span><span class="err">\</span><span class="o">*</span> <span class="nt">alernatively</span> <span class="err">\</span><span class="o">*/</span></code></pre></figure> <p>You can read more about this <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/-moz-appearance">here</a>. I also found that changing box sizing could help in the “undesign” process. Smarter people than me explained <a href="http://www.paulirish.com/2012/box-sizing-border-box-ftw/">how it works</a>, you can <a href="http://quirksmode.org/css/user-interface/boxsizing.html">read about it</a> or try it out like this:</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nt">-webkit-box-sizing</span><span class="o">:</span> <span class="nt">border-box</span><span class="o">;</span></code></pre></figure> <h3 id="removing-gray-highlight-when-tapping-links">Removing Gray Highlight When Tapping Links</h3> <p>On mobile Safari, tapped links will get quickly highlighted, which doesn’t look very “native” once embeded in a Steroids JS webview. This is especialy true for images. Change this using:</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nt">-webkit-tap-highlight-color</span><span class="o">:</span> <span class="nf">#123456</span><span class="o">;</span> <span class="o">/</span><span class="err">\</span><span class="o">*</span> <span class="nt">To</span> <span class="nt">change</span> <span class="nt">it</span> <span class="err">\</span><span class="o">*/</span>
<span class="nt">-webkit-tap-highlight-color</span><span class="o">:</span> <span class="nt">transparent</span><span class="o">;</span> <span class="o">/</span><span class="err">\</span><span class="o">*</span> <span class="nt">To</span> <span class="nt">remove</span> <span class="nt">it</span> <span class="err">\</span><span class="o">*/</span></code></pre></figure> <p>I found that changing the color feels better than removing it.</p> <h3 id="overflow-scrolling">Overflow Scrolling</h3> <p>If you have some elements that are set to scroll when overflowing, you might feel that the scrolling itself doesn’t “feel right”. I suggest looking in this direction:</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"> <span class="nt">-webkit-overflow-scrolling</span><span class="o">:</span> <span class="nt">touch</span><span class="o">;</span></code></pre></figure> <h3 id="on-fluid-layouts">On Fluid Layouts</h3> <p>Using percentages for size can be a good option to handle different screen sizes. Just know that there is a <a href="https://github.com/twbs/bootstrap/issues/9282">known issue</a> where Safari rounds up percentages that can cause for weird behaviors when using fluid layouts.</p> <h2 id="retina">Retina</h2> <p>If you build for iOS, you have to take retina into account. Spoiler: it’s a pain.</p> <h3 id="the-big-idea">The Big Idea</h3> <blockquote> <p>Retina Display is a brand name used by Apple for liquid crystal displays that have a pixel density high enough that the human eye is unable to discern individual pixels at a typical viewing distance.</p> <p><a href="http://en.wikipedia.org/wiki/Retina_Display">wikipedia</a></p> </blockquote> <p>The short version of how to deal with it is pretty straightforward: create images twice as big, call them my_image@2x.jpg and resize them in CSS.</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nt">background</span><span class="o">:</span> <span class="nt">url</span><span class="o">(</span><span class="nt">my</span><span class="err">\</span><span class="nt">_image</span><span class="nc">.jpg</span><span class="o">);</span>
<span class="nt">background-size</span><span class="o">:</span> <span class="nt">100px</span> <span class="nt">100px</span><span class="o">;</span> <span class="o">/</span><span class="err">\</span><span class="o">*</span> <span class="nt">with</span> <span class="nt">my</span><span class="err">\</span><span class="nt">_image</span><span class="nc">.jpg</span> <span class="nt">being</span> <span class="nt">200x200</span> <span class="nt">px</span> <span class="err">\</span><span class="o">*/</span></code></pre></figure> <h3 id="dont-bother-with-normal-size">Don’t Bother With Normal Size</h3> <p>If all your images are in your build and not on a remote server, I would recommend always loading the @2x version. The rule of thumb is that if it looks fine in retina, it will look fine in 1x and embeding the 1x image will only increase your build’s size and complexify the way you manage your assets.</p> <h3 id="background-position">Background Position</h3> <p>Be careful when using background positions with background sizes as they sometimes <a href="http://stackoverflow.com/questions/17033806/background-size-with-background-position-doesnt-scale-the-position">don’t play well together</a>.</p> <h3 id="px-border">1px Border</h3> <p>If you specify a 1px border in your CSS, a 2px border will be displayed on retina displays. Yeah, this is pretty unituitive and a major pain. There are a lot of ways to try to get this to work.</p> <p>This might not be best for you but, for my use case, I found <a href="https://excellenteasy.com/devblog/posts/how-to-target-physical-pixels-on-retina-screens-with-css/">Stephan Bönnemann’s solution</a> simpler, and I ended adding a DOM element and styling it like this:</p> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"physical_1px"</span><span class="nt">&gt;&lt;/div&gt;</span></code></pre></figure> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.physical</span><span class="err">\</span><span class="nt">_1px</span><span class="p">{</span>
  <span class="nl">background-image</span><span class="p">:</span> <span class="n">linear-gradient</span><span class="p">(</span><span class="m">0deg</span><span class="p">,</span> <span class="m">#DFDFDF</span><span class="p">,</span> <span class="m">#DFDFDF</span> <span class="m">50%</span><span class="p">,</span> <span class="nb">transparent</span> <span class="m">50%</span><span class="p">);</span>
  <span class="nl">background-size</span><span class="p">:</span> <span class="m">100%</span> <span class="m">1px</span><span class="p">;</span>
  <span class="nl">background-repeat</span><span class="p">:</span> <span class="nb">no-repeat</span><span class="p">;</span>
  <span class="nl">background-position</span><span class="p">:</span> <span class="nb">bottom</span><span class="p">;</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">1px</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <p>This is not ideal, but I wasn’t a fan of the alternatives either. Check them out and make an opinion for yourself:</p> <ul> <li><a href="http://atirip.com/2013/09/22/yes-we-can-do-fraction-of-a-pixel/">Yes We Can Do Fraction Of A Pixel</a></li> <li><a href="http://n12v.com/css-retina-and-physical-pixels/">CSS, Retina, and Physical Pixels</a></li> <li><a href="http://makandracards.com/makandra/12019-css-emulate-borders-with-inset-box-shadows">CSS: Emulate borders with inset box shadows</a></li> </ul> <h2 id="performances">Performances</h2> <h3 id="avoid-http-calls">Avoid HTTP Calls</h3> <p>This seems obvious, but embed as many images and javascript libraries as possible in your build. It will run on mobile, and connectivity is an issue there. Yes it does increases build size, but it’s totally worth it.</p> <h3 id="jquery-">jQuery ?</h3> <p>I used jQuery. There, I said it.</p> <p>I knew it would degrade performances, but I benchmarked it a bit versus Vanilla JS and the difference was not really noticable for my use cases, so I kept it because I’m used to the syntax and it <a href="/blog/2013/11/05/enough-with-the-language-trolls/">gets the job done</a>.</p> <p>Of course I followed <a href="http://www.artzstudio.com/2009/04/jquery-performance-rules/">the usual performances tips</a>, not too much DOM manipulation, do not reselect the same element over and over etc.</p> <h3 id="css-performances">CSS Performances</h3> <h4 id="animations">Animations</h4> <p>On a lot of devices CSS animations are slow. Often it’s not slow enough you want to stop using them altogether, but they are still not that good.</p> <p>My point is that you should not count on perfectly smooth animations when designing your app.</p> <h4 id="linear-gradients-qtwebkit-and-graphics">Linear Gradients, QtWebkit and Graphics</h4> <p>During development I did run into major CSS performance issues. I’m not even kidding. This happened when I tried to apply an animation to a div with a linear-gradient.</p> <blockquote> <p>Sometimes it’s tempting to use webkit’s drawing features, like -webkit-gradient, when it’s not actually necessary - maintaining images and dealing with Photoshop and drawing tools can be a hassle. However, using CSS for those tasks moves that hassle from the designer’s computer to the target’s CPU. Gradients, shadows, and other decorations in CSS should be used only when necessary (e.g. when the shape is dynamic based on the content) - **otherwise, static images are always faster**. On very low-end platforms, it’s even advised to use static images for some of the text if possible.</p> <p><a href="https://trac.webkit.org/wiki/QtWebKitGraphics#Usestaticimages">webkit.org</a></p> </blockquote> <p>The solution here is to prefer using images as background images rather than CSS gradients. This is irritating, but I never found a way around this performance issue.</p> <h3 id="javascript">JavaScript</h3> <p>I’m not going to explain everything about JS performances. This could be a serie of articles in itself. It could even be a book. Actually, it is a book! <a href="http://shop.oreilly.com/product/9780596802806.do">Go check it out</a>!</p> <p>To sum it up: reuse objects, do not lock processes, be evented, large arrays will slow everything down.</p> <h2 id="working-with-steroidsjs">Working with SteroidsJS</h2> <p>Alright, we talked a lot of general facts that could apply to any hybrid HTML 5 / CSS 3 app, but what about SteroidsJS itself?</p> <h3 id="learning">Learning</h3> <p>Like any new libraries there will be problems, bugs and API changes. It is important to keep up to date, I’d suggest:</p> <ul> <li>Following what goes on in the <a href="http://forums.appgyver.com">forums</a></li> <li>Keep an eye on the <a href="http://blog.appgyver.com/changelog/">changelog</a> and the <a href="http://blog.appgyver.com/">blog</a></li> </ul> <p>For documentation and tips on how to code:</p> <ul> <li>Use <a href="http://docs.appgyver.com/en/edge/index.html">the API documentation</a> which is quite extensive. Be aware that it is very poorly referenced on Google right now so you’ll have to be precise in your searches.</li> <li>Reading <a href="http://academy.appgyver.com/">the tutorials</a> is a must. They are well done and give a good overview of what the technology can do. There are also a lot of good step by step examples.</li> </ul> <h3 id="organizing-code">Organizing Code</h3> <p>I personnally didn’t go the AngularJS route because it felt overkill for what I tried to achieve. I also didn’t like the MVC solution proposed by basic steroids scaffolding. In the end what worked for me was quite view-centric approach that looked like this:</p> <ul> <li>/app/views/my_scope/action.html (a view in a separate webview)</li> <li>/app/controllers/my_scope/action.js (all the JS related to a view)</li> <li>/app/models/data_persistence.js (everything that is transversal and relates to data)</li> <li>/www/javascripts/application.js (shared code between all views)</li> </ul> <p>Overall once I set it up like this, it was easier to figure out what would interact with what.</p> <h2 id="basic-customization--features">Basic Customization &amp; Features</h2> <h3 id="slider">Slider</h3> <p>If you’re in need of a touch slider, I recommend using <a href="https://github.com/thebird/Swipe">Swipe.Js</a>. It’s both simple, effective and very customizable.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">mySwipe</span> <span class="o">=</span> <span class="nx">Swipe</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'slider'</span><span class="p">));</span></code></pre></figure> <p>The only gotcha is that you won’t be able to put inputs in a slide because text edition (long press on iOS) will not work properly.</p> <h3 id="hammerjs">Hammer.js</h3> <p><a href="http://eightmedia.github.io/hammer.js/">Hammer</a> ships with Steroids JS, so I gave it a try. Overall it works fine for some events such as tap or release, but the way it handles clicks seemed buggy. I can’t quite put my finger on it, but in some cases I was better of just using jQuery for click events.</p> <h3 id="use-clicks">Use Clicks</h3> <p>When in doubt, use links and their click event. It will feel better for the end user than using tap or any other event. There is no need to get fancy.</p> <h3 id="loader">Loader</h3> <p>I liked having a global way of calling a loader in any view and centralize the style and retry logic. The javascript code is pretty domain specific to my app, but I’ll share the CSS part if you want it to look like this:</p> <div style="text-align: center"><img src="/assets/misc/loader.jpg" /></div> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"loader"</span> <span class="na">class=</span><span class="s">"loader"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"text_load"</span> <span class="na">class=</span><span class="s">"loader_content"</span> <span class="na">data-t=</span><span class="s">"loading"</span><span class="nt">&gt;</span>...<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"retry_load"</span> <span class="na">class=</span><span class="s">"loader_content"</span> <span class="na">data-t=</span><span class="s">"retry"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"loader"</span> <span class="na">id=</span><span class="s">"loader_overlay"</span><span class="nt">&gt;&lt;/div&gt;</span></code></pre></figure> <p>The loader overlay is to prevent any clicking to happened while the loader is present on the screen. The retry_load and text_load are the elements displayed when it succeeds or fails.</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="err">#</span> <span class="nt">loader</span><span class="p">{</span>
  <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
  <span class="nl">top</span><span class="p">:</span> <span class="m">130px</span><span class="p">;</span>
  <span class="nl">left</span><span class="p">:</span> <span class="m">70px</span><span class="p">;</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#000</span><span class="p">;</span>
  <span class="nl">z-index</span><span class="p">:</span> <span class="m">9999</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">190px</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.2em</span><span class="p">;</span>
  <span class="nl">opacity</span><span class="p">:</span> <span class="m">0.8</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
  <span class="nl">color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
  <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
<span class="p">}</span>
<span class="err">#</span> <span class="nt">retry</span><span class="err">\</span><span class="nt">_load</span><span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.loader</span><span class="err">\</span><span class="nt">_content</span><span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">70px</span> <span class="m">0px</span><span class="p">;</span>
<span class="p">}</span>

<span class="err">#</span> <span class="nt">loader</span><span class="err">\</span><span class="nt">_overlay</span><span class="p">{</span>
  <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
  <span class="nl">top</span><span class="p">:</span> <span class="m">0px</span><span class="p">;</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">620px</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">320px</span><span class="p">;</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#000</span><span class="p">;</span>
  <span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">z-index</span><span class="p">:</span> <span class="m">500</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <p>As you can see, the CSS is very simple. Again, not claiming to provide the definitive solution here, just some guidance. Feel free to improve on it and add a comment.</p> <h3 id="settings">Settings</h3> <p>I think I managed to get a decent looking settings tab, but I didn’t find anything that would do it out of the box. Here’s a screenshot:</p> <div style="text-align: center"><img src="/assets/misc/settings_liff.jpg" /></div> <p>I’m not perfectly happy with the way I had to do it, so I won’t share it even if it does look fine. However you can take a look at what I used for the checkbox <a href="http://www.cyberantics.net/toggle.html">here</a>. I found it in a comment on <a href="http://www.designcouch.com/home/why/2013/09/19/ios7-style-pure-css-toggle/">a very interesting article</a>. Based on this I only had to change a couple of things (webkit-appearance, mostly) to get it to work perfectly within my app.</p> <h3 id="local-storage">Local Storage</h3> <p>Here is a quick extract of my User model using the <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Storage#localStorage">localStorage API</a> for persistence.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">User</span> <span class="o">=</span> <span class="p">{</span>

  <span class="na">id</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
	<span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">"liff_id"</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="nl">setStatsMode</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>
	<span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">"liff_stats_mode"</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="c1">// Way more things go here</span>
<span class="p">}</span></code></pre></figure> <p>If I were to complexify my data model, I would consider using <a href="https://github.com/AppGyver/steroids-plugins/tree/master/sqlite">SQLite</a>.</p> <h2 id="deeper-into-steroidsjs-and-cordova">Deeper Into SteroidsJS and Cordova</h2> <h3 id="i18n">I18n</h3> <p>I decided to create my app in both French and English, so I had to deal with internationalization right away. I prefered handling it in the app rather than creating multiple builds or other complicated solutions. The performance problem was a non issue thanks to preloading (as explained further below).</p> <p>Working with SteroidsJS means working with Cordova/PhoneGap. In this case the <a href="http://docs.phonegap.com/en/2.2.0/cordova_globalization_globalization.md.html">globalization API</a>.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"deviceready"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
	<span class="nx">navigator</span><span class="p">.</span><span class="nx">globalization</span><span class="p">.</span><span class="nx">getPreferredLanguage</span><span class="p">(</span>
	  <span class="kd">function</span> <span class="p">(</span><span class="nx">language</span><span class="p">)</span> <span class="p">{</span>
	    <span class="nx">localize</span><span class="p">(</span><span class="nx">language</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
	  <span class="p">},</span>
	  <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
	    <span class="nx">localize</span><span class="p">(</span><span class="s2">"en"</span><span class="p">)</span>
	  <span class="p">}</span>
	<span class="p">)</span>
  <span class="p">})</span>
<span class="p">})</span>

<span class="kd">function</span> <span class="nx">localize</span><span class="p">(</span><span class="nx">language</span><span class="p">){</span>
  <span class="nx">$</span><span class="p">(</span><span class="s2">"body"</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"id"</span><span class="p">,</span> <span class="nx">language</span><span class="p">)</span>
  <span class="nx">$</span><span class="p">(</span><span class="s2">"\*[data-t]"</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
	<span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">I18n</span><span class="p">[</span><span class="nx">language</span><span class="p">][</span><span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">"t"</span><span class="p">)])</span>
  <span class="p">})</span>
<span class="p">}</span></code></pre></figure> <p>… meaning it will use my I18n object (very basic JSON) and replace the content of any HTML element with a data-t attribute. The body ID is set so I can load different images in CSS if needed.</p> <p>I find it very easy to use every day and it’s decent performance wise if you don’t have too much text displayed.</p> <h3 id="preloading">Preloading</h3> <p>Preloading is great, it really speeds up everything.</p> <p>As explained above, I internationalized my whole app. Because of this I’d have a couple of miliseconds blink before the text appears. Preloading views fixed this.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">someView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">steroids</span><span class="p">.</span><span class="nx">views</span><span class="p">.</span><span class="nx">WebView</span><span class="p">(</span><span class="s2">"/views/settings/some\_view.html"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">anotherView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">steroids</span><span class="p">.</span><span class="nx">views</span><span class="p">.</span><span class="nx">WebView</span><span class="p">(</span><span class="s2">"/views/settings/another\_view.html"</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">preload</span><span class="p">(){</span>
  <span class="nx">someView</span><span class="p">.</span><span class="nx">preload</span><span class="p">()</span>
  <span class="nx">anotherView</span><span class="p">.</span><span class="nx">preload</span><span class="p">()</span>
<span class="p">}</span></code></pre></figure> <p>I also wait a bit before actually preloading the views, so the first app load time is reduced. I think it’s better to only preload when you really need it in order to preserve ressources.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">preload</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span></code></pre></figure> <p>Learn more about it on <a href="http://academy.appgyver.com/categories/3/contents/19">AppGyver’s website</a>.</p> <p>_Note that this not fully functional in production on my app because of an issue in Steroids JS where loading the navigation bar in a certain way disrupts preloading. Because of this you will see some minor blinking in some internal setting screens. It will be fixed soon :)_</p> <h3 id="getting-out-of-the-background">Getting Out Of The Background</h3> <p>You might want to do something when the user reopens the app after putting it in the background. Here’s how to do it:</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"resume"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="c1">// Do things</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span></code></pre></figure> <h3 id="communicate-between-views">Communicate Between Views</h3> <p>Using <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window.postMessage">the postMessage API</a> to communicate between views is the way to go.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">/</span><span class="err">\</span><span class="o">*</span> <span class="nx">In</span> <span class="nx">the</span> <span class="nx">first</span> <span class="nx">view</span> <span class="err">\</span><span class="o">*</span><span class="sr">/</span><span class="err">
</span><span class="nb">window</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="s2">"something\_happened"</span> <span class="p">},</span> <span class="s2">"\*"</span><span class="p">)</span>

<span class="sr">/</span><span class="se">\*</span><span class="sr"> In the second view </span><span class="se">\*</span><span class="sr">/</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"message"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s2">"something\_happened"</span><span class="p">){</span>
  <span class="p">}</span>
<span class="p">})</span></code></pre></figure> <p>_Right now there is an open issue when adding alerts in the event listener as discussed [on the forum)[http://forums.appgyver.com/#!/steroids:sometimes-alerts-block-th)_.</p> <h2 id="check-out-the-result">Check Out The Result!</h2> <p>Of course you don’t have to take my word for it, give my application a try !</p> <p>It’s called Liff and is <a href="https://itunes.apple.com/en/app/liff-understand-your-life/id834944345">available on the appstore</a>. The goal is to give a <a href="http://liffapp.io">relevant way to get insights on ones day</a> and we put in extra efforts in order to create a pleasant experience with a solid design.</p> <div style="text-align: center"><img src="/assets/misc/liff_screen.jpg" /></div> <p>Clearly creating an hybrid app is easier than ever, but there is still a lot of things to keep in mind when doing so. Projects like PhoneGap push the ball in the right direction and I can’t wait to see what kind of apps we’ll be creating in a few years!</p> <div id="more"> <div id="more-articles"> <p>Since you scrolled this far, you might be interested in some other things I wrote!</p> <ul> <li><a href="/blog/2013/08/29/appgyver-steroids-iphone-hybrid-javascript/">My First Impressions of AppGyver's Steroids.js</a></li> <li><a href="/blog/2012/11/12/webviews-javascript-ios-rubymotion/">Web Views &amp; RubyMotion</a></li> <li><a href="/blog/2012/10/22/custom-slider-ios-rubymotion/">Create a Custom Slider With RubyMotion</a></li> <li><a href="/books/">Startup & Tech Book Reviews</a> </ul> </div> <a href="https://twitter.com/marcgg" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @marcgg</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> <a href="https://twitter.com/share" class="twitter-share-button" data-via="marcgg" data-size="large">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> </div> <div id="comments"> <style id="disqus_hide"> #disqus_thread{ display: none; } </style> <p> <span id="show-disqus-arrow">&rarr; </span> <a href="#" id="show-disqus">Read the comments or contribute with your own</a> </p> <div id="disqus_thread"></div> </div> <script type="text/javascript"> var disqus_shortname = 'marcgg'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> </div> </div> </div> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <script src="/assets/js/comments.js"></script> <link rel="preload" href="/assets/css/code.css" as="style" onload="this.rel='stylesheet'"> <script> /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */ !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); /*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */ !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); </script> <footer> <div>Website powered by <a href="https://github.com/jekyll/jekyll">Jekyll</a>, hosted on <a href="https://github.com/marcgg/marcgg.github.com">Github</a> and put together by <a href="http://twitter.com/marcgg">@marcgg</a>.</div> <div>All of the <a href="/blog">blog's articles</a> are under <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative commons</a> license unless stated otherwise. Everything else is &copy;.</div> </footer> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-31071519-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>

