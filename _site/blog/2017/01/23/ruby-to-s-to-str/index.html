<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <title> The Difference Between to&#95;s & to&#95;str In Ruby </title> <meta name="description" content="A lot of people assume that to_s and `to_str` are the same methods, but the difference between them is actually quite major."> <meta name="author" content="Marc G Gauthier"> <meta content='user-scalable=no, width=device-width, initial-scale=1.0' name='viewport'> <meta name="google-site-verification" content="x2EpQdOMz-k9fP8hak9I3COaXhnQ4jNLp2GU4GYQ8jM" /> <link href='//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic|Open+Sans:300italic,700italic,400,700,300' rel='stylesheet' type='text/css'> <link href="/atom.xml" rel="alternate" type="application/atom+xml" title="Marcgg#Blog"> <link rel="shortcut icon" href="/assets/favicon.png"> <style type="text/css"> /* http://meyerweb.com/eric/tools/css/reset/ v2.0 | 20110126 License: none (public domain) */ html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video { margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline; } /* HTML5 display-role reset for older browsers */ article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section { display: block; } body { line-height: 1; } ol, ul { list-style: none; } blockquote, q { quotes: none; } blockquote:before, blockquote:after, q:before, q:after { content: ''; content: none; } table { border-collapse: collapse; border-spacing: 0; } .clearfix:after { content: "."; display: block; clear: both; visibility: hidden; line-height: 0; height: 0; } .clearfix { display: inline-block; } html[xmlns] .clearfix { display: block; } * html .clearfix { height: 1%; } @font-face { font-family: 'anonymousregular'; src: url('/assets/fonts/Anonymous-webfont.eot'); src: url('/assets/fonts/Anonymous-webfont.eot?#iefix') format('embedded-opentype'), url('/assets/fonts/Anonymous-webfont.woff') format('woff'), url('/assets/fonts/Anonymous-webfont.ttf') format('truetype'), url('/assets/fonts/Anonymous-webfont.svg#anonymousregular') format('svg'); font-weight: normal; font-style: normal; } body{ font-size: 15px; font-family: 'Droid Serif', serif; color: #545454; line-height: 25px; } #gradient{ height: 5px; background: rgba(237,82,82,0.64); background: -moz-linear-gradient(left, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); background: -webkit-gradient(left top, right top, color-stop(0%, rgba(237,82,82,0.64)), color-stop(20%, rgba(250,21,0,0.65)), color-stop(52%, rgba(237,82,82,0.66)), color-stop(80%, rgba(255,21,0,0.66)), color-stop(100%, rgba(237,82,82,0.67))); background: -webkit-linear-gradient(left, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); background: -o-linear-gradient(left, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); background: -ms-linear-gradient(left, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); background: linear-gradient(to right, rgba(237,82,82,0.64) 0%, rgba(250,21,0,0.65) 20%, rgba(237,82,82,0.66) 52%, rgba(255,21,0,0.66) 80%, rgba(237,82,82,0.67) 100%); filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ed5252', endColorstr='#ed5252', GradientType=1 ); } /* STRUCTURE */ #container{ background-color: #fafafa; } #content{ width: 760px; margin: auto; margin-top: 20px; padding-bottom: 60px; padding-top: 40px; } /* FOOTER */ footer{ padding: 40px 0px; text-align: center; border-top: 1px solid #e6e6e6; font-size: 0.8em; color: #9a9a9a; background-color: #fafafa; } footer a{ color: #9a9a9a; } /* HEADER */ header{ width: 760px; margin: auto; height: 50px; border-bottom: 1px solid #f1f1f1; position: relative; } #more-nav{ font-size: 0.75em; display: inline-block;; position: absolute; top: 0px; font-family: "anonymousregular"; padding-top: 5px; right: 0px; } #more-nav a{ padding: 0px 2px; text-decoration: none; color: #545454; } #more-nav a:hover{ transition: 0s; background-image: linear-gradient(to bottom, #fff 30%, rgba(200, 200, 200, 0.4) 50%); background-repeat: repeat-x; background-size: 2px 2px; background-position: 0px 100%; } #more-nav .selected{ color: #ed5252; font-weight: bold; } #logo{ font-size: 1.2em; font-family: "anonymousregular"; margin-top: 20px; } #logo *{ text-decoration: none; } #logo1{ color: #999; } #logo2{ font-size: 0.8em; color: #ed5252; } #logo3{ color: #545454; } #logo a:hover{ color: #ed5252; transition-duration: 1s; } /* TEXT STRUCTURE */ h1, h2, h3, h4, h5{ font-family: 'Open Sans', sans-serif; color: #1c1c1c; } h2, h3, h4, h5{ text-transform: capitalize; } a:hover{ color: #ed5252; transition-duration:0.2s; } p a, ul a, .review a{ color: #763232; text-decoration: none; background-image: linear-gradient(to bottom, #fff 30%, rgba(200, 200, 200, 0.4) 50%); background-repeat: repeat-x; background-size: 2px 2px; background-position: 0px 100%; } p{ text-align: justify; margin-bottom: 20px; } .excerpt p{ margin-bottom: 0px; } .footnote, .sidenote{ margin: 40px 0px; color: #858585; text-align: right; font-size: 0.9em; font-style: italic; } .image_notes{ text-align: center; color: #858585; font-size: 0.9em; margin: -5px 0px 15px 0px; } h1{ font-size: 2.45em; text-align: center; margin: 70px 0px 20px 0px; line-height : 1.5em; } h1 em{ color: #888; font-weight: normal; font-size: 0.8em; } h2{ font-size: 1.75em; margin: 50px 0px 50px 0px; line-height: 1.75em; } h2::before{ content: "#"; color: #ed5252; font-family: "anonymousregular"; display: inline-block; float: left; padding: 3px 10px 0px 0px; font-size: 0.7em; } h3{ font-size: 1.35em; margin-bottom: 20px; } h4{ font-size: 1.2em; margin-bottom: 20px; font-style: italic; } h5{ font-size: 1.3em; margin-bottom: 20px; } h5 *{ color: #545454; } em{ font-style: italic; } strong{ font-weight: bold; } blockquote{ border-left: 3px solid #ddd; color: #888; margin: 0px 0px 20px 40px; font-style: italic; } blockquote p{ margin: 5px 20px !important; } ul{ padding-left: 40px; line-height: 25px; list-style: square; margin-bottom: 20px; } li{ display: list-item; } ol{ padding-left: 40px; line-height: 25px; margin-bottom: 20px; list-style-type: decimal; } /* TAGS */ .home-tag { font-size: 10px; display: inline-block; border: 1px solid #dedede; padding: 2px 2px 1px 2px; border-radius: 2px; line-height: 10px; margin-left: 1px; } .tag-date{ color: #dedede; } .tag-management { border-color: #929aff; color: #929aff; } .tag-programming { border-color: #ff9292; color: #ff9292; } .tag-coaching { border-color: #4ec698; color: #4ec698; } .tag-projectmanagement { border-color: #929aff; color: #929aff; } /* BLOG INDEX */ #all-posts{ margin: 0px auto 10px auto; width: 760px; } .single-post{ border-top: 1px solid #f1f1f1; padding: 40px 0px; float: clear; } .single-post:first-child{ border-top: none !important; } .single-post .date{ color: #cdcdcd; margin-top: 10px; float: right; } .single-post .author{ color: #cdcdcd; float: right; font-size: 0.7em; } .single-post .title{ font-family: 'Open Sans', sans-serif; font-size: 1.6em; margin-bottom: 20px; line-height: 1.6em; position: relative; } .single-post .title a{ color: #545454; text-decoration: none; } .single-post .title a::before{ content: "→"; opacity: 0; font-family: "anonymousregular"; font-size: 0.7em; position: absolute; left: -30px; transition: all .4s ease-in-out; } .single-post .title a:hover::before{ opacity: 1; transition: all .4s ease-in-out; color: #ed5252; } .single-post .title em{ display: none; } .data_table{ border: 1px solid #efefef; font-family: "anonymousregular"; font-size: 12px; margin: auto auto 20px auto; } .data_table tr{ border: 1px solid #efefef; } .data_table th{ background-color: #efefef; } .data_table th, .data_table td{ padding: 2px 5px; } /* BOOKS */ .book-cover-entry{ width: 120px; margin-right: 20px; float: left; font-size: 12px; text-decoration: none !important; } .buy-book{ text-decoration: underline; } .book-cover-entry img{ width: 120px; } .book-cover-entry { background-image: none; } .book-rating .icon { display: inline-block; padding-right: 5px; } .book-rating .top .icon{ color: #1CED00; } .book-rating .good .icon{ color: #82ED00; } .book-rating .medium .icon{ color: #EDD100; } .book-rating .low .icon{ color: #EDAE00; } .book-rating .poor .icon{ color: #ED3B00; } #buy-title{ padding: 0px 0px 25px 0px; } #buy-title span{ font-size: 0.8em !important; color: #cdcdcd; } #buy-popin{ padding: 30px 15px; } .store{ display: block; padding: 15px 5px; text-decoration: none; } .store:hover{ color: #ed5252; } #upcoming-books{ padding-top: 20px; } #upcoming-books img{ height: 90px; margin-right: 10px; border: 1px solid #fff; } #upcoming-books a{ text-decoration: none; } #upcoming-books img:hover{ border: 1px solid #ed5252; } /* BLOG SHOW */ .post{ padding-top: 20px; } p code, li code{ background-color: #efefef; font-family: "Lucida Console", "Courier New", Courier, monospace; padding: 1px 2px; font-size: 13px; } .post img{ border: 1px solid #e6e6e6; padding: 5px; margin: 0px 0px 20px 20px; } .published span{ border-top: 1px solid #e6e6e6; display: inline-block; color: #858585; padding-top: 5px; font-family: 'Open Sans', sans-serif; font-size: 0.9em; padding: 5px 20px 0px 20px; } .published{ text-align: center; margin-bottom: 25px; } #more{ border-top: 1px solid #e6e6e6; margin-top: 40px; padding: 40px 0px; } #more-articles{ margin-bottom: 40px; } .image-wrapper em{ display: block; font-size: 0.8em; margin: -20px 0px 20px 0px; color: #aaa; } .twitter-tweet{ margin: auto; max-width: 420px !important; } #book-review{ border: 1px dashed #dedede; padding: 20px; margin-bottom: 20px; opacity: 0.7; font-style: italic; } /* Music */ .js_play_sound, .js_stop_sound{ display: inline-block; padding: 4px 10px 2px 10px; border: 1px solid #efefef; background-color: #efefef; margin-right: 10px; text-decoration: none; border-radius: 3px; font-family: 'anonymousregular'; font-size: 12px; } .js_play_sound:hover, .js_stop_sound:hover{ background-color: #dedede; } /* Comments */ #comments{ padding-top: 20px; } #show-disqus-arrow{ color: #ed5252; } /* CLEARFIX */ .cf:before, .cf:after { content: " "; /* 1 */ display: table; /* 2 */ } .cf:after { clear: both; } /************************ MOBILE LAYOUT *********************/ @media all and (max-width: 800px) { .home-tag { display: none; } .author{ float: none !important; display: inline; } header{ width: 92%; padding: 4%; height: 75px; position: relative; text-align: center; background-color: #fafafa; } #more-nav{ left: 0px; top: 50px; } #logo{ margin-top: 10px; } #content, #all-posts{ width: 92%; padding: 4%; } .image-wrapper{ width: 100%; } .image-wrapper img, .post div img, .post p img{ max-width: 100% !important; padding: 15px 0px !important; margin: 20px 0px 20px 0px !important; border-right: 0px; border-left: 0px; } .single-post .title{ font-size: 1.4em; } .date{ display: none; } h1{ font-size: 1.7em; width: 94%; padding: 3%; } h2{ font-size: 1.50em; margin: 30px 0px 30px 0px; line-height: 1.75em; } h3{ font-size: 1.30em; } blockquote{ margin: 0px 0px 20px 0px !important; } pre{ margin-left: 0px !important; margin-right: 0px !important; width: 90%; overflow-x: scroll; } code{ width: 100%; font-size: 13px !important; } footer div{ display: inline; } /* Hire me responsive */ #hire ul{ padding-left: 15px; } #talking-img{ width: 100%; } #talking-img img{ width: 100% !important; } #reviews{ border-top: 1px dashed #e6e6e6; padding: 15px 0px 15px 0px; } #references_logo{ padding: 0px 0px 15px 0px; } .review{ width: 100%; margin: 0px 0px 15px 0px; padding: 0px; border-bottom: 1px dashed #e6e6e6; } #references_logo img, #references_logo .minor{ width: 22%; float: left; margin: 15px 2% 15px 0px; } .data_table th, .data_table td{ font-size: 8px; padding: 0px; border: 1px solid #efefef; } } </style> </head> <body> <div id="gradient"></div> <header> <div id="logo"> <a id='logo1' href="/">marcgg</a> <span id='logo2'>#</span> <a id='logo3' href="/blog/"> blog </a> </div> <div id="more-nav"> &rarr; <a href="/blog/" class="selected">blog</a> &rarr; <a href="/books/" class="">books</a> &rarr; <a href="/hire/" class="">hire me</a> </div> </header> <h1> <span> The Difference Between to&#95;s & to&#95;str In Ruby </span> </h1> <div class="published"> <span>23 January 2017</span> </div> <div id="container"> <div id="content"> <div class="post" id="post-"> <p>If you ever looked at the available methods on some objects in Ruby, you might have noticed that there seems to be two different ways to cast an object to string: <code class="highlighter-rouge">to_s</code> and <code class="highlighter-rouge">to_str</code>. However, most people only use <code class="highlighter-rouge">to_s</code>… is it because it’s shorter or is <code class="highlighter-rouge">to_str</code> functionally different?</p> <p>Short answer: they are indeed different.</p> <p><em>Note that this article focuses on <code class="highlighter-rouge">to_s</code> vs <code class="highlighter-rouge">to_str</code>, but the logic applies as well to <code class="highlighter-rouge">to_int</code>, <code class="highlighter-rouge">to_ary</code>, <code class="highlighter-rouge">to_hash</code>, <code class="highlighter-rouge">to_regexp</code> and <code class="highlighter-rouge">to_sym</code>.</em></p> <h2 id="difference-in-scope-of-definition">Difference In Scope Of Definition</h2> <p>First of, <code class="highlighter-rouge">to_s</code> is defined on a lot of elements. To demonstrate this, let’s create a new class <code class="highlighter-rouge">Demo</code> and call <code class="highlighter-rouge">to_s</code> on a new instance of this class:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Demo</span>
<span class="k">end</span>

<span class="nb">puts</span> <span class="no">Demo</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">to_s</span></code></pre></figure> <p>This returns:</p> <div class="highlighter-rouge"><pre class="highlight"><code>#&lt;Demo:0x007fc49b05a408&gt;
</code></pre></div> <p>We could also call <code class="highlighter-rouge">to_s</code> directly on the class and get a valid result as well since the <code class="highlighter-rouge">Class</code> <a href="https://ruby-doc.org/core-2.2.0/Class.html">class is also an object</a>:</p> <div class="highlighter-rouge"><pre class="highlight"><code>&gt; Class.to_s
=&gt; "Class"
&gt; Class.new.to_s
=&gt; "#&lt;Class:0x007f8f5c02f5b0&gt;"
</code></pre></div> <p>However if we try to do the same with <code class="highlighter-rouge">to_str</code>, it won’t work because it’s not defined on a higher level class:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">puts</span> <span class="no">Demo</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">to_str</span></code></pre></figure> <p>This will return <code class="highlighter-rouge">undefined method to_str for #&lt;Demo:0x007fea8204e290&gt; (NoMethodError)</code>, meaning that we have to define it ourselves when creating a new class.</p> <h2 id="difference-in-behavior">Difference In Behavior</h2> <p>Alright, so the methods are not defined in the same way… but this is just a minor detail compared to the main difference between the two:</p> <ul> <li><code class="highlighter-rouge">to_s</code> returns a string representation of an object</li> <li><code class="highlighter-rouge">to_str</code> is actually stating that the object behaves like a string!</li> </ul> <h3 id="string-representation-of-an-object">String Representation Of An Object</h3> <p>When calling <code class="highlighter-rouge">to_s</code>, it will return some form of string representation of the object. Something easy to display.</p> <p>When creating a new class you can keep the default behaviour or build your own. For instance here’s how <code class="highlighter-rouge">to_s</code> behaves on an integer:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="mi">100</span><span class="p">.</span><span class="nf">to_s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># returns "1100100"</span>
<span class="mi">100</span><span class="p">.</span><span class="nf">to_s</span> <span class="c1"># returns "100"</span>
<span class="mi">100</span><span class="p">.</span><span class="nf">to_s</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="c1"># returns"144"</span></code></pre></figure> <p>Here’s what it could look like if you were defining it yourself:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">User</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
   <span class="vi">@name</span> <span class="o">=</span> <span class="nb">name</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">to_s</span>
   <span class="s2">"User: </span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure> <p>It’s basically just a way to have a quick and nice way to display your objects that is going to be called when needed, for instance when using <code class="highlighter-rouge">puts</code> or when interpolating with <code class="highlighter-rouge">#{}</code>:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">puts</span> <span class="s2">"Here is </span><span class="si">#{</span><span class="no">User</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"Bob"</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span> <span class="c1"># Returns "Here is User: Bob"</span></code></pre></figure> <h3 id="behaving-like-a-string">Behaving Like A String</h3> <p>Calling <code class="highlighter-rouge">to_str</code> should return a string-like object, behaving just like a <code class="highlighter-rouge">String</code>.</p> <p>On the other hand when an object implements <code class="highlighter-rouge">to_str</code>, it has way more consequences as it means that it will return something that behaves like a string. It’s basically saying that the class is not necessarily a <code class="highlighter-rouge">String</code>, but it can be used in the same way.</p> <p>Because of this, the only class in Ruby core implementing <code class="highlighter-rouge">to_str</code> is <code class="highlighter-rouge">String</code>:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">rb_str_to_s</span><span class="p">(</span><span class="n">VALUE</span> <span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">rb_obj_class</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="o">!=</span> <span class="n">rb_cString</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">str_duplicate</span><span class="p">(</span><span class="n">rb_cString</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="k">return</span> <span class="n">str</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <p><a href="http://apidock.com/ruby/Exception/to_str">Exception</a> used to implement <code class="highlighter-rouge">to_str</code> as well but is was removed in Ruby 1.9, which is why it’s often mentioned as an example. The Ruby documentation was even wrong at the time of writing this article, so I wrote <a href="https://github.com/ruby/ruby/pull/1517">a PR to fix it</a> that was merged.</p> <p>There are a lot of discussions regarding if a class should implement <code class="highlighter-rouge">to_str</code> or not, since it’s a strong signal that the class is really similar to a string and should behave as such. If this sounds interesting, you should take a look at this <a href="https://bugs.ruby-lang.org/issues/7849">Symbol#to_str</a> discussion on the Ruby core tracker, or at <a href="https://github.com/rails/rails/commit/188cc90af9b29d5520564af7bd7bbcdc647953ca">this example in Rails</a> of when <code class="highlighter-rouge">to_str</code> is useful by <a href="https://twitter.com/tenderlove">Aaron Patterson</a>.</p> <h4 id="example-1-fixnum">Example 1: Fixnum</h4> <p><code class="highlighter-rouge">Fixnum</code> does not define <code class="highlighter-rouge">to_str</code>, so when we do this:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">puts</span> <span class="s2">"150"</span> <span class="o">+</span> <span class="mi">42</span></code></pre></figure> <p>We get <code class="highlighter-rouge">'+': no implicit conversion of Fixnum into String (TypeError)</code>. This makes sense, but what would happen if we were to define <code class="highlighter-rouge">to_str</code> on the <code class="highlighter-rouge">Fixnum</code> class?</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Fixnum</span>
  <span class="k">def</span> <span class="nf">to_str</span>
   <span class="nb">self</span><span class="p">.</span><span class="nf">to_s</span>
  <span class="k">end</span>
<span class="k">end</span>
 </code></pre></figure> <p>The when we call:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">puts</span> <span class="s2">"150"</span> <span class="o">+</span> <span class="mi">42</span></code></pre></figure> <p>We get <code class="highlighter-rouge">"15042"</code>, which is quite surprising! It’s because <code class="highlighter-rouge">42</code> was implicitly converted to a <code class="highlighter-rouge">String</code>.</p> <h4 id="example-2-user">Example 2: User</h4> <p>Going back to our other example, we could add <code class="highlighter-rouge">to_str</code> to the <code class="highlighter-rouge">User</code> class and get the ability to use <code class="highlighter-rouge">+</code> to concatenate an instance of <code class="highlighter-rouge">User</code> with a string:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">User</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
   <span class="vi">@name</span> <span class="o">=</span> <span class="nb">name</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">to_str</span>
   <span class="vi">@name</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="nb">puts</span> <span class="s2">"Say hello to "</span> <span class="o">+</span> <span class="no">User</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"Bob"</span><span class="p">)</span> <span class="c1"># Displays "Say hello to Bob"</span></code></pre></figure> <h2 id="note-on-implicit--explicit-conversion">Note On Implicit / Explicit Conversion</h2> <p>We can also say that <code class="highlighter-rouge">to_s</code> is an explicit conversion and <code class="highlighter-rouge">to_str</code> is an implicit conversion. I’m not going into the details of this, if you’d like to get more information I recommend reading <a href="http://amzn.to/2iV2Ngq">Confident Ruby</a>.</p> <p>Quoting directly from the book:</p> <blockquote> <p><code class="highlighter-rouge">to_s</code> is an explicit conversion method. Explicit conversions represent conversions from classes which are mostly or entirely unrelated to the target class.</p> <p><code class="highlighter-rouge">to_str</code>, on the other hand, is an implicit conversion method. Implicit conversions represent conversions from a class that is closely related to the target class.</p> <p><em><a href="http://amzn.to/2iV2Ngq">Confident Ruby by Avdi Grimm</a></em></p> </blockquote> <h2 id="summing-it-up">Summing It Up</h2> <p>That’s a lot of information, but let me sum it up quickly before finishing the article:</p> <ul> <li><code class="highlighter-rouge">to_s</code> and <code class="highlighter-rouge">to_str</code> are <strong>very different</strong>.</li> <li><code class="highlighter-rouge">to_s</code> is defined on most objects and returns a string representation of this object.</li> <li>Defining <code class="highlighter-rouge">to_str</code> on an object is very much like saying “this object behaves like a string”.</li> <li>Calling <code class="highlighter-rouge">to_str</code> should return a string-like object, not juste a representation of the object as a string.</li> </ul> <p><em>Note that both <code class="highlighter-rouge">to_s</code> and <code class="highlighter-rouge">to_str</code> should return an instance of <code class="highlighter-rouge">String</code>, even when subclassing <code class="highlighter-rouge">String</code>.</em></p> <div id="more"> <div id="more-articles"> <p>Since you scrolled this far, you might be interested in some other things I wrote!</p> <ul> <li><a href="/blog/2018/10/22/regression-testing-for-data-ruby/">Regression Testing For Data</a></li> <li><a href="/blog/2018/05/15/expressing-intent-comments-ruby/">Expressing Intent Without Comments In Ruby</a></li> <li><a href="/blog/2016/08/22/csrf-rails/">Understanding Rails' Forgery Protection Strategies</a></li> <li><a href="/blog/2016/05/09/rails-app-engine/">First Impressions: Rails 5 on Google App Engine</a></li> <li><a href="/blog/2016/02/15/rspec-on-multiple-rails-projects/">Automatically Run RSpec on Multiple Projects</a></li> <li><a href="/books/">Startup & Tech Book Reviews</a> </ul> </div> <a href="https://twitter.com/marcgg" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @marcgg</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> <a href="https://twitter.com/share" class="twitter-share-button" data-via="marcgg" data-size="large">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> </div> <div id="comments"> <style id="disqus_hide"> #disqus_thread{ display: none; } </style> <p> <span id="show-disqus-arrow">&rarr; </span> <a href="#" id="show-disqus">Read the comments or contribute with your own</a> </p> <div id="disqus_thread"></div> </div> <script type="text/javascript"> var disqus_shortname = 'marcgg'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> </div> </div> </div> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <script src="/assets/js/comments.js"></script> <link rel="preload" href="/assets/css/code.css" as="style" onload="this.rel='stylesheet'"> <script> /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */ !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); /*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */ !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); </script> <footer> <div>Website powered by <a href="https://github.com/jekyll/jekyll">Jekyll</a>, hosted on <a href="https://github.com/marcgg/marcgg.github.com">Github</a> and put together by <a href="http://twitter.com/marcgg">@marcgg</a>.</div> <div>All of the <a href="/blog">blog's articles</a> are under <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative commons</a> license unless stated otherwise. Everything else is &copy;.</div> </footer> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-31071519-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>

